<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>IOT-server</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="../socket.io/socket.io.js"></script>

</head>

<body>
    <style type="text/css">
        .sp-picker-container {
            width: 500px
        }

    </style>

    <div class="container" style="padding: 20px">
        <div style="display: flex; align-content: center; justify-content: center;">
            <div>
                <h2 style="font-weight: 900; text-align: center; margin: 0; margin-bottom: 20px">LED CONTROLL</h2>
            </div>
        </div>
        <div style="display: flex; align-items: center; justify-content: center;" id="control">
            <div style="align-self: flex-start;">
                <div>
                    <label>LED 1</label>
                    <input class="checkLed" value="1" data-width="50" data-height="30" type="checkbox" data-toggle="toggle">
                </div>
                <div>
                    <label>LED 2</label>
                    <input class="checkLed" value="2" data-width="50" data-height="30" type="checkbox" data-toggle="toggle">
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    var socket = io('192.168.1.118:3000');
    var listDevice = [];
    jQuery.ajax({
        url: "/devices",
        type: "GET",
        contentType: 'application/json; charset=utf-8',
        success: function(resultData) {
            listDevice = resultData;
        },
        error: function(jqXHR, textStatus, errorThrown) {},

        timeout: 120000,
    });
    $('.checkLed').change(function(event) {
        var id = $(this).val();
        var data = $(this).prop('checked');
        listDevice.forEach(function(device) {
            if (device.id == id) {
                var json = "{'id':" + id + ",'name':'" + device.name + "','state':" + data + "}"
                socket.emit('led-change', json);
                console.log(json);
            }
        })

    });

</script>

</html>
